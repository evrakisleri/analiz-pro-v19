<script type="module">
    import { supabase } from './supabaseClient.js';

    // Sayfa açıldığında müdür mü kontrol et
    async function checkAdmin() {
        const { data: { user } } = await supabase.auth.getUser();
        if (!user) { window.location.href = 'index.html'; return; }

        const { data: profile } = await supabase.from('users').select('*').eq('email', user.email).single();
        if (profile?.role !== 'admin') {
            alert("YETKİSİZ ERİŞİM!");
            window.location.href = 'index.html';
        }
    }
    checkAdmin();

    // Toplu Öğrenci Ekleme Fonksiyonu
    window.uploadStudents = async (studentList) => {
        const { error } = await supabase.from('users').insert(studentList);
        if (error) alert("Hata: " + error.message);
        else alert("Öğrenciler başarıyla yüklendi!");
    };
</script>
